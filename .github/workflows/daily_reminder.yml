name: Daily Report Reminder (Mon-Sat)

on:
  schedule:
    # UTC 10:30 = åŒ—äº¬æ—¶é—´ 18:30ï¼Œä»…å‘¨ä¸€åˆ°å‘¨å…­ï¼ˆ1=å‘¨ä¸€, 6=å‘¨å…­ï¼‰
    - cron: '30 10 * * 1-6'
  workflow_dispatch:  # å…è®¸æ‰‹åŠ¨æµ‹è¯•

jobs:
  send-reminder:
    runs-on: ubuntu-latest
    steps:
      - name: Send Beautiful Markdown Reminder
        env:
          WECHAT_KEY: ${{ secrets.WECHAT_BOT_KEY }}
        run: |
          # è·å–ä¸­æ–‡æ˜ŸæœŸ
          WEEKDAY=$(date '+%u')
          case $WEEKDAY in
            1) CN_DAY="å‘¨ä¸€" ;;
            2) CN_DAY="å‘¨äºŒ" ;;
            3) CN_DAY="å‘¨ä¸‰" ;;
            4) CN_DAY="å‘¨å››" ;;
            5) CN_DAY="å‘¨äº”" ;;
            6) CN_DAY="å‘¨å…­" ;;
          esac
          DATE_STR=$(date '+%mæœˆ%dæ—¥')
          REPORT_URL="https://byjyedu.yuque.com/org-wiki-byjyedu-bxo6fa/bmqx33/gz2ixgatwha0u07k"

          # å‘é€å…¼å®¹ä¼ä¸šå¾®ä¿¡ç¾¤æœºå™¨äººçš„ Markdown æ¶ˆæ¯
          curl "https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=$WECHAT_KEY" \
            -H 'Content-Type: application/json' \
            -d '{
              "msgtype": "markdown",
              "markdown": {
                "content": "#### ğŸ“… <font color=\"info\">æ—¥æŠ¥æäº¤æé†’</font>\n\n> **æ—¶é—´**ï¼š'$DATE_STR'ï¼ˆ'$CN_DAY'ï¼‰Â· <font color=\"warning\">19:00 æˆªæ­¢</font>\n> **è¦æ±‚**ï¼šè¯·å®Œæ•´å¡«å†™ä»Šæ—¥å·¥ä½œå†…å®¹\n\n[âœ… ç«‹å³å¡«å†™æ—¥æŠ¥]('$REPORT_URL')\n\n@all"
              }
            }'
